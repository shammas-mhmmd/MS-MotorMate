<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>MS MotorMate • Access</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: Poppins, sans-serif;
      background: radial-gradient(circle at top, #1e1b4b, #020617);
      overflow: hidden;
    }

    .card {
      width: 360px;
      padding: 36px;
      background: rgba(15, 23, 42, .85);
      backdrop-filter: blur(16px);
      border-radius: 20px;
      box-shadow: 0 40px 80px rgba(0, 0, 0, .6);
      animation: fade .5s ease;
    }

    @keyframes fade {
      from {
        opacity: 0;
        transform: translateY(25px)
      }

      to {
        opacity: 1;
        transform: none
      }
    }

    h1 {
      margin: 0 0 6px;
      color: #fff
    }

    p {
      margin: 0 0 24px;
      color: #94a3b8;
      font-size: 14px
    }

    input {
      width: 100%;
      padding: 14px;
      margin-bottom: 14px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, .1);
      background: rgba(2, 6, 23, .9);
      color: #fff;
      outline: none;
    }

    button {
      width: 100%;
      padding: 14px;
      border-radius: 14px;
      border: none;
      background: linear-gradient(135deg, #6366f1, #818cf8);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
    }

    .links {
      display: flex;
      justify-content: space-between;
      margin-top: 14px;
      font-size: 13px;
    }

    .links a {
      color: #818cf8;
      cursor: pointer;
      text-decoration: none;
    }

    #error {
      margin-top: 12px;
      color: #f87171;
      font-size: 13px;
      text-align: center;
      display: none;
    }
  </style>
</head>

<body>

  <div class="card">

    <h1>MS MotorMate</h1>
    <p id="subtitle">Sign in to continue</p>

    <!-- LOGIN -->
    <div id="loginView">
      <input id="loginUser" placeholder="Email Address">
      <input id="loginPass" type="password" placeholder="Password">
      <button id="loginBtn" onclick="login()">Login</button>

      <div class="links">
        <a onclick="show('register')">Create account</a>
        <a onclick="show('forgot')">Forgot password?</a>
      </div>
    </div>

    <!-- REGISTER -->
    <div id="registerView" style="display:none">
      <input id="regEmail" placeholder="Email">
      <input id="regPass" type="password" placeholder="Password">
      <button id="regBtn" onclick="createAccount()">Create Account</button>

      <div class="links">
        <a onclick="show('login')">← Back to login</a>
      </div>
    </div>

    <!-- FORGOT -->
    <div id="forgotView" style="display:none">
      <input id="forgotEmail" placeholder="Registered email">
      <button id="forgotBtn" onclick="resetPassword()">Send reset link</button>

      <div class="links">
        <a onclick="show('login')">← Back to login</a>
      </div>
    </div>

    <div id="error"></div>

  </div>

  <!-- Firebase SDKs (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

  <script>
    // Firebase Config (Must match cloud.js)
    const firebaseConfig = {
      apiKey: "AIzaSyD_q5kf3ALaE8hi06xZEzvcbMhkEjxCFGU",
      authDomain: "motormate-one.firebaseapp.com",
      projectId: "motormate-one",
      storageBucket: "motormate-one.firebasestorage.app",
      messagingSenderId: "193216239840",
      appId: "1:193216239840:web:49c5e92237b6bd79eb5885"
    };

    // Initialize Firebase
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }

    const auth = firebase.auth();

    function show(view) {
      loginView.style.display = "none";
      registerView.style.display = "none";
      forgotView.style.display = "none";

      subtitle.textContent =
        view === "login" ? "Sign in to continue" :
          view === "register" ? "Create a new account" :
            "Recover your password";

      document.getElementById(view + "View").style.display = "block";
      error.style.display = "none";
    }

    function login() {
      const email = loginUser.value;
      const pass = loginPass.value;
      const btn = document.getElementById("loginBtn");

      if (!email || !pass) {
        showError("Please enter email and password");
        return;
      }

      btn.innerText = "Connecting...";
      btn.disabled = true;

      auth.signInWithEmailAndPassword(email, pass)
        .then(() => {
          localStorage.setItem("ms_logged_in", "true");
          location.href = "index.html";
        })
        .catch(e => {
          showError(e.message);
          btn.innerText = "Login";
          btn.disabled = false;
        });
    }

    function createAccount() {
      const email = regEmail.value;
      const pass = regPass.value;
      const btn = document.getElementById("regBtn");

      if (!email || !pass) {
        showError("Please fill all fields");
        return;
      }

      btn.innerText = "Creating...";
      btn.disabled = true;

      auth.createUserWithEmailAndPassword(email, pass)
        .then(() => {
          localStorage.setItem("ms_logged_in", "true");
          location.href = "index.html";
        })
        .catch(e => {
          showError(e.message);
          btn.innerText = "Create Account";
          btn.disabled = false;
        });
    }

    function resetPassword() {
      const email = forgotEmail.value;
      const btn = document.getElementById("forgotBtn");

      if (!email) {
        showError("Please enter your email");
        return;
      }

      btn.innerText = "Sending...";
      btn.disabled = true;

      auth.sendPasswordResetEmail(email)
        .then(() => {
          alert("Reset link sent to " + email);
          show('login');
        })
        .catch(e => {
          showError(e.message);
          btn.innerText = "Send reset link";
          btn.disabled = false;
        });
    }

    function showError(msg) {
      error.textContent = msg;
      error.style.display = "block";
    }
  </script>

</body>

</html>